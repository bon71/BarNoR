# 📚 Notion Barcode Reader - ユーザーガイド

**バーコードをスキャンして、書籍・商品情報を自動でNotionに保存するiOSアプリ**

このガイドでは、Notion Barcode Readerの使い方を初心者にもわかりやすく説明します。

---

## 🎯 目次

1. [初回セットアップ](#初回セットアップ)
2. [バーコードスキャンの使い方](#バーコードスキャンの使い方)
3. [パッケージ管理](#パッケージ管理)
4. [履歴の確認](#履歴の確認)
5. [設定](#設定)
6. [よくある質問（FAQ）](#よくある質問faq)
7. [トラブルシューティング](#トラブルシューティング)

---

## 🚀 初回セットアップ

### ステップ1: Notion Integration Tokenの取得

1. **Notion にログイン**
   - ブラウザで [Notion](https://www.notion.so/) にアクセスしてログイン

2. **Integrations ページへ移動**
   - [https://www.notion.so/my-integrations](https://www.notion.so/my-integrations) にアクセス

3. **新しいIntegrationを作成**
   - **"+ New integration"** ボタンをクリック
   - 以下を入力・選択：
     - **Name**: `NotionBarcodeReader`（任意の名前）
     - **Associated workspace**: 使用するワークスペースを選択
     - **Capabilities**（権限）:
       - ✅ **Read content** （読み取り）
       - ✅ **Update content** （更新）
       - ✅ **Insert content** （挿入）

4. **Tokenをコピー**
   - **Submit** をクリック
   - **Internal Integration Token** が表示されます
   - `secret_` で始まる文字列を **コピー** してください
   - ⚠️ このTokenは誰にも見せないでください

---

### ステップ2: Notionデータベースの作成

1. **Notionで新しいページを作成**
   - Notionワークスペースで **新しいページ** を作成
   - ページタイトル: `📚 読書リスト`（任意）

2. **データベースを追加**
   - ページ内で `/database` と入力
   - **Database - Table** を選択

3. **プロパティを追加**
   
   以下のプロパティを作成してください：

| プロパティ名 | タイプ | 説明 | 必須 |
|------------|------|------|------|
| **タイトル** | Title | 書籍のタイトル | ✅ |
| **著者名** | Text | 著者の名前 | ✅ |
| **ISBN** | Text | ISBNコード | ✅ |
| **書影** | Files & media | 書籍の表紙画像 | 推奨 |
| **出版社** | Text | 出版社名 | オプション |
| **発行日** | Date | 発行日 | オプション |

4. **Integrationを接続**
   - データベースページの右上 **"..."** メニューをクリック
   - **"Add connections"** を選択
   - 先ほど作成した **Integration**（NotionBarcodeReader）を選択

5. **Database IDを取得**
   - データベースページのURLをコピー：
     ```
     https://www.notion.so/myworkspace/abc123def456?v=...
                                      ^^^^^^^^^^^^
                                      この部分がDatabase ID
     ```
   - `abc123def456` の部分をメモしてください

---

### ステップ3: アプリの初回設定

1. **アプリを起動**
   - Notion Barcode Reader アプリを開く

2. **設定タブへ移動**
   - 画面下部のタブバーから **⚙️ 設定** をタップ

3. **Notion Integration Tokenを入力**
   - **"Notion Integration Token"** 欄に、ステップ1でコピーしたTokenを貼り付け
   - **認証** ボタンをタップ
   - ✅ "認証に成功しました" と表示されればOK

4. **パッケージタブへ移動**
   - 画面下部のタブバーから **📦 パッケージ** をタップ

5. **デフォルトパッケージを設定**
   - **"書籍登録"** パッケージをタップ
   - **データベースID** 欄に、ステップ2で取得したDatabase IDを貼り付け
   - **保存** をタップ
   - **アクティブ化** ボタンをタップ

6. **完了！**
   - これで初回セットアップは完了です
   - さっそくバーコードをスキャンしてみましょう！

---

## 📱 バーコードスキャンの使い方

### 基本的な使い方

1. **ホームタブへ移動**
   - 画面下部のタブバーから **🏠 ホーム** をタップ

2. **スキャン開始**
   - **"スキャン開始"** ボタンをタップ
   - 初回のみ、カメラ権限を求められます → **許可** をタップ

3. **バーコードをスキャン**
   - 書籍の **裏表紙** にあるISBNバーコードにカメラを向ける
   - バーコードが自動認識されると、カメラが閉じます

4. **書籍情報の確認**
   - OpenBD APIから自動で書籍情報が取得されます
   - タイトル・著者・書影などが表示されます

5. **Notionに保存**
   - 内容を確認して **"Notionに保存"** ボタンをタップ
   - ✅ "保存しました" と表示されればOK
   - Notionデータベースを開いて確認してみましょう！

### スキャンのコツ

- 📏 **距離**: バーコードから15〜20cm程度離す
- 💡 **明るさ**: 明るい場所でスキャン（暗い場所は認識しにくい）
- 📐 **角度**: バーコードに対してカメラを垂直に向ける
- 🔄 **リトライ**: うまくいかない場合は、距離や角度を変えて再試行

---

## 📦 パッケージ管理

### パッケージとは？

**パッケージ** = Notionデータベース + プロパティマッピング設定

複数のNotionデータベースを「パッケージ」として登録・管理できます。

**例**:
- **書籍登録パッケージ** → `📚 読書リスト` データベース
- **欲しいものリストパッケージ** → `🛒 買い物リスト` データベース
- **DVD/Blu-rayパッケージ** → `🎬 映画コレクション` データベース

---

### 新しいパッケージの作成

1. **パッケージタブへ移動**
   - 画面下部のタブバーから **📦 パッケージ** をタップ

2. **新規作成ボタンをタップ**
   - 画面右上の **"+ 新規作成"** ボタンをタップ

3. **パッケージ情報を入力**
   - **パッケージ名**: 任意の名前（例: "欲しいものリスト"）
   - **説明**: 任意（オプション）

4. **データベースを選択**
   - **"データベースを選択"** をタップ
   - 連携済みのNotionデータベース一覧が表示されます
   - 使用したいデータベースを選択

5. **プロパティマッピングを設定**
   - **"プロパティマッピング"** をタップ
   - スキャンデータの各項目（タイトル・著者・ISBNなど）を、Notionのプロパティに対応付けます

   **例**:
   - スキャンデータ: `タイトル` → Notion: `タイトル` プロパティ
   - スキャンデータ: `著者` → Notion: `著者名` プロパティ
   - スキャンデータ: `ISBN` → Notion: `ISBN` プロパティ

6. **保存**
   - 設定が完了したら **"保存"** をタップ
   - パッケージ一覧に追加されます

---

### パッケージの切り替え

1. **パッケージタブへ移動**
   - 画面下部のタブバーから **📦 パッケージ** をタップ

2. **パッケージを選択**
   - 一覧から使用したいパッケージをタップ

3. **アクティブ化**
   - **"アクティブ化"** ボタンをタップ
   - ✅ "アクティブなパッケージを変更しました" と表示されればOK

4. **以降のスキャンは、アクティブなパッケージに保存されます**

---

### パッケージの編集

⚠️ **現在、パッケージの編集機能は実装中です**（v1.0.0で対応予定）

現在は、パッケージを削除して再作成してください。

---

### パッケージの削除

1. **パッケージタブへ移動**
   - 画面下部のタブバーから **📦 パッケージ** をタップ

2. **パッケージを長押し**
   - 削除したいパッケージを **長押し**

3. **削除を選択**
   - **"削除"** をタップ
   - 確認ダイアログが表示されます

4. **削除実行**
   - **"削除"** をタップして確定
   - ⚠️ デフォルトパッケージは削除できません

---

## 📜 履歴の確認

### スキャン履歴を見る

1. **履歴タブへ移動**
   - 画面下部のタブバーから **📜 履歴** をタップ

2. **履歴一覧が表示されます**
   - スキャンした日時順に表示
   - タイトル・著者・スキャン日時が確認できます

3. **詳細を確認**
   - 履歴アイテムをタップすると、詳細情報が表示されます

---

## ⚙️ 設定

### Notion Integration Token

- **変更**: 新しいTokenを入力して **"認証"** をタップ
- **削除**: **"ログアウト"** をタップ（すべてのデータが削除されます）

### テーマ（ライト/ダーク）

- システム設定に応じて自動切り替え
- iOS設定アプリの **"画面表示と明るさ"** で変更できます

### バージョン情報

- 設定画面の最下部にバージョン番号が表示されます

---

## ❓ よくある質問（FAQ）

### Q1. ISBNバーコードがない書籍は登録できますか？

**A**: 現在のバージョン（v1.0）では、ISBNバーコードが必須です。手動入力機能は今後のアップデートで対応予定です。

---

### Q2. 商品のJANコードもスキャンできますか？

**A**: JANコード（商品バーコード）のスキャンは、現在開発中です（v1.1で対応予定）。

---

### Q3. 複数の書籍を連続でスキャンできますか？

**A**: 現在は1冊ずつスキャン → 保存の流れです。一括スキャン機能は今後のアップデートで対応予定です。

---

### Q4. オフラインでも使えますか？

**A**: 現在のバージョンでは、オンライン（インターネット接続）が必須です。オフライン対応は今後のアップデートで対応予定です。

---

### Q5. Androidでも使えますか？

**A**: 現在はiOSのみ対応です。Android版は今後のアップデートで対応予定です。

---

### Q6. 書籍情報が取得できない場合は？

**A**: 以下を確認してください：
- インターネット接続が正常か確認
- ISBNコードが正しいか確認（13桁または10桁）
- 古い書籍や海外の書籍は、OpenBD APIに登録されていない場合があります

---

### Q7. Notionデータベースに保存されない場合は？

**A**: 以下を確認してください：
- Notion Integration Tokenが正しいか確認
- Notionデータベースに Integration が接続されているか確認
- データベースIDが正しいか確認
- プロパティマッピングが正しいか確認

---

## 🛠️ トラブルシューティング

### カメラが起動しない

**原因**: カメラ権限が許可されていない

**解決方法**:
1. iOSの **設定アプリ** を開く
2. **NotionBarcodeReader** を選択
3. **カメラ** を **オン** に変更
4. アプリを再起動

---

### Notion認証エラー

**原因**: Integration Tokenが間違っているか、期限切れ

**解決方法**:
1. [Notion Integrations](https://www.notion.so/my-integrations) にアクセス
2. Integration Tokenを再発行
3. アプリの設定画面で新しいTokenを入力
4. **認証** をタップ

---

### 書籍情報が取得できない

**原因**: OpenBD APIにデータが登録されていない、またはネットワークエラー

**解決方法**:
1. インターネット接続を確認
2. 別の書籍で試してみる
3. ISBNコードを手動で確認（間違っていないか）

---

### アプリがクラッシュする

**原因**: メモリ不足、バグ

**解決方法**:
1. アプリを完全に終了して再起動
2. iPhoneを再起動
3. アプリを再インストール
4. それでも解決しない場合は、[GitHub Issues](https://github.com/bon71/NotionBarcodeReader/issues) で報告してください

---

## 📧 お問い合わせ・サポート

### バグ報告・機能要望

- **GitHub Issues**: [https://github.com/bon71/NotionBarcodeReader/issues](https://github.com/bon71/NotionBarcodeReader/issues)

### その他のお問い合わせ

- **開発者**: bon71
- **GitHub**: [@bon71](https://github.com/bon71)

---

## 📝 プライバシー・利用規約

- **プライバシーポリシー**: [docs/PRIVACY_POLICY_ja.md](PRIVACY_POLICY_ja.md)
- **利用規約**: [docs/TERMS_OF_SERVICE_ja.md](TERMS_OF_SERVICE_ja.md)

---

**このガイドで解決しない問題がある場合は、お気軽にお問い合わせください！**

**Happy Scanning! 📚✨**
